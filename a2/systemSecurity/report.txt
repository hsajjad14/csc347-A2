1) [2 Marks]
	Command to init the database: /usr/sbin/tripwire --init
	Command to run a check: /usr/sbin/tripwire --check
	Command to get a report: /usr/sbin/twprint -m r --twrfile /var/lib/tripwire/report/ubuntu804Server-20201031-173656.twr
	Place the report in twreport1.txt

2a) [5 Marks] Document the steps you took to 'take the drive out of the Ubuntu804_owasp VM and place it in the Kali VM'. 
	1) First shutdown the Ubuntu804_owasp vm.

	2) Remove the drive from the Ubuntu804_owasp VM
        	To do this in the VM:
            		- On the top click "VM" and then click "Settings..."
            		- In the new window that opened, click on "Hard Disk (SCSI)"
            		- click the "Remove" button at the bottom of the window and then press OK

 	3) Attach the Ubuntu804_osap drive to the Kali VM.
          	To do this in the VM:
            		- Open the kali VM in another window (but do not power it on)
		        - On the top click "VM" and then click "Settings..."
		        - In the new window that opened up, click the button that says "Add..." near the bottom left
            		- Click Hard Disk then click next
            		- Pick SCSI disk type and then click next
            		- Pick "Use an existing virtual disk" then click next
            		- Click "Browse" and go to the folder where Ubuntu804Server_owasp is stored on your computer
            		- Open the Ubuntu virtual disk (Ubuntu.vmdk)
            		- Click "Finish" and then click "Keep Existing Format"
            		- Click "OK" at the bottom right

  	4) Power on Kali VM. It now has access to its original drive as well as the drive from the Ubuntu804_owasp VM



2b) [3 Marks] Copy the shadow file to the Kali VM and see if you 
    can determine some of the passwords using John the ripper. 

	PLACE john the ripper results below. 

	Created directory: /root/.john
  	Warning: detected hash type "md5crypt", but the string is also recognized as "md5crypt-long"
  	Use the "--format=md5crypt-long" option to force loading these as that type instead
  	Using default input encoding: UTF-8
  	Loaded 5 password hashes with 5 different salts (md5crypt, crypt(3) $1$ (and variants) [MD5 128/128 XOP 4x2])
  	Will run 4 OpenMP threads
  	Proceeding with single, rules:Single
  	Press 'q' or Ctrl-C to abort, almost any other key for status
  	Warning: Only 26 candidates buffered for the current salt, minimum 32 needed for performance.
  	Warning: Only 27 candidates buffered for the current salt, minimum 32 needed for performance.
  	joeeoj           (joe)
  	Warning: Only 20 candidates buffered for the current salt, minimum 32 needed for performance.
  	Warning: Only 23 candidates buffered for the current salt, minimum 32 needed for performance.
  	Warning: Only 5 candidates buffered for the current salt, minimum 32 needed for performance.
  	Warning: Only 19 candidates buffered for the current salt, minimum 32 needed for performance.
  	Warning: Only 29 candidates buffered for the current salt, minimum 32 needed for performance.
  	Almost done: Processing the remaining buffered candidate passwords, if any.
  	Warning: Only 2 candidates buffered for the current salt, minimum 32 needed for performance.
  	Warning: Only 22 candidates buffered for the current salt, minimum 32 needed for performance.
  	Warning: Only 28 candidates buffered for the current salt, minimum 32 needed for performance.
  	Further messages of this type will be suppressed.
  	To see less of these warnings, enable 'RelaxKPCWarningCheck' in john.conf
  	Proceeding with wordlist:/usr/share/john/password.lst, rules:Wordlist
  	password         (arnold)
  	Proceeding with incremental:ASCII
	
	After waiting ~8 hours, we were able to crack 2 out of the 5 accounts.
 	We can use 'john shadow --show' to see the results.

	john shadow --show
	arnold:password:16861:0:99999:7:::
	joe:joeeoj:16735:0:99999:7:::

	2 password hashes cracked, 3 left

	We can conclude that the other 3 accounts have relativly safe passwords,
	as they weren't able to be cracked in single crack mode or wordlist mode,
	and after a long time in brute force mode, John the Ripper still hasn't cracked
	the passwords. 

2c) [2 Marks] Modify user sid so that they are now a root user with password 'password'. 

	EXPLAIN HOW YOU DO THIS AND PLACE MODIFIED FILES ETC IN THIS DIRECTORY
	
	To do this, I first edited the /etc/passwd file of the Ubuntu804_owasp drive.
	I changed both the UID and GID of sid to be 0. This makes sid a root user and
	in the root group.

		BEFORE:
				root:x:0:0:root:/root:/bin/bash
				sid:x:1003:1003::/home/sid:/bin/bash
    		AFTER:
				root:x:0:0:root:/root:/bin/bash
				sid:x:0:0::/home/sid:/bin/bash

	To change the password of sid to 'password', I used the results of John the
	Ripper. From the results I learned that the user arnold has the password
	'password'. To give sid this same password, I went to the /etc/shadow file in
	the Ubuntu804Server_owasp drive and replaced the hash and salt that is currently
	stored for sid with the hash and salt that is stored for arnold.

		BEFORE:
				arnold:$1$dIvnzRCg$gHM9YMivSDtPZ1KApSBIe.:16861:0:99999:7:::
				sid:$1$fb4hbPgA$BYM2rUZa53dbwf/eTN3uk/:16735:0:99999:7:::

		AFTER:
				arnold:$1$dIvnzRCg$gHM9YMivSDtPZ1KApSBIe.:16861:0:99999:7:::
				sid:$1$dIvnzRCg$gHM9YMivSDtPZ1KApSBIe.:16735:0:99999:7:::
				

2d) NOTHING TO REPORT HERE

3a) [2 Marks] Place the result of running tripwire in twreport2.txt. 
	Identify anything interesting below.	
	
	From the results of the tripwire report we see clear evidence that our system
	has been modified as this report found 8266 total violations.
	Some important changes we see is that the /etc directory has been modified.
	/etc/passwd and /etc/shadow have both been modified. We can also see that
	in the /bin directory, /bin/cat and /bin/ps have been modified.
	We do not expect these files to have been modified between the two
	tripwire scans, so this indicates that there has been an attack. 

3b) [4 Marks] 
	last # this is a command

		WHAT DID YOU LEARN
	
		This command shows you login records of the system. We can see all the users
		that logged in and out along with the date and time. We can also see when the 
		system reboots. From this we see that after arnold last logged off,
		there was a system reboot, and then sid had logged in to the system.
		Since the tripwire report shows us that our system has been altered, this 
		command shows us that sid is a likely suspect and/or the system was altered 
		when it was shut down.
		 
	uptime # this is a command

		WHAT DID YOU LEARN
		
		Some information that we can get from this command is that we can see how 
		long the system has been running and also how many users are currently 
		logged on to the system. From this we see that while there is only 1 user
		currently logged on, we can see that the system has a very short
		uptime, meaning it was previously shutdown and rebooted recently. This is an
		unexpected reboot as this shutdown was not done by us, so it shows
		evidence of a potential attack where an attacker could have powered off the 
		system to modify it.

	/var/log/* # these are log files

		WHAT DID YOU LEARN
		
 		A file we can look at is auth.log which shows the authentication logs of the
		system. From this we can see that a session opened for user sid by LOGIN(uid = 0)
		and there was a ROOT LOGIN and then the session closed. From this we learned that 
		sid was able to log in as a root user on the system.

	.bash_history # what is this, whos should you look at and why are you looking?

		WHAT DID YOU LEARN
		
		This file a history of commands that have been executed by the user.
		This is useful as you can see what they have done on the system. 
		From this you can determine whether there is evidence of a potential attack
		and can begin to fix it. A good idea is after we get a suspicious tripwire 
		report we should examine all accounts that logged in between the last report
	        and the new suspicious report to view if any of these users have been
		compromised and a potential attack is being performed through these users.

		Since sid is the user that logged in between scans, we will look at this users
	        .bash_history file. From this file we see that this user did touch /bin/cat
		and touch /bin/ps before logging out. This explains the modifications that we
		see in the tripwire report, and while there doesn't appear to be any malicious
		modifications, we can clearly see that sid is a root user when they should not be.



4) [2 Marks] List updates to policy below. 

	Updates to policy that we can make is that we can run John the Ripper against
	the accounts in our system and require any users with passwords that are easily
	cracked (such as passwords that are able to be cracked in single crack
	or wordlist mode) to change them, and also require passwords to be changed
	regularly.
	
	We should also ensure that the server room is locked at all times and only
	authorized individuals are allowed access in. This will make it harder for an
	attacker to get physical access to the hard drive. The hard drives should also
	be encrypted so if the hacker does get physical access to the drive,
	they will not be easily able to view the information as they must crack the
	encryption first.
	
	Tripwire should be frequently ran, and logs should also be constantly 
	monitored in order to detect any suspicious activity early on and stop attacks
	before substantial damage is done. Programs such as Logwatch should be used to
	aid in analyzing the logs.
	
	Backups should also be made frequently and stored in a separate location from the
	system. This will aid in recovery as if an attack occurs and there is damage
	to the system, it can recovered by reverting back to one of the backups.

5) [2 Marks] Report on what the attacker could have done to leave fewer traces than they did in this attack. 
	What would you do to detect a compromise even in this case? 

	One way the hacker could leave fewer traces is that they could modify the
	tripwire program. Since the system is compromised, if tripwire is stored
	on the system the hacker can manipulate the tripwire program as well, so the
	hacker could be able to change the database. This way when the sysadmin runs
	tripwire again, there will not be reports of any tampering.

	In order to detect a compromise in this case we should store the tripwire
	database somewhere offline and off of the system we are trying to protect,
	such as in a USB drive. Then for any checks we want to make, on a separate, secure
	operating system, we mount the drive of the system that we are trying to run the
	check on, and install a clean version of tripwire (or you can also have an 
	original tripwire application stored in the offline drive as well). We then
	run the tripwire check on the system's drive, using the database we stored in
	the USB.

	Another way the hacker can leave fewer traces is by clearing the .bash_history
	after they have made their modifications. They could do this by using commands
	such as cat /dev/null > ~/.bash_history in all the terminals. This will leave
	behind fewer traces as there will no longer be a record of the commands that
	the hacker done.

	To detect a compromise in this case, the defender should use the cleared
	.bash_history log as an indicator that an attack might have occurred and begin
	carrying out recovery measures (such as backing up the system,etc). This is because
	a cleared .bash_history shows that a hacker might have carried out an attack
	and has taken the steps to hide their tracks.


